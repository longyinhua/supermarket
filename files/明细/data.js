$axure.loadCurrentPage(
(function() {
    var _ = function() { var r={},a=arguments; for(var i=0; i<a.length; i+=2) r[a[i]]=a[i+1]; return r; }
    var _creator = function() { return _(b,c,d,e,f,g,h,g,i,_(j,k),l,[m],n,_(o,p,q,r,s,t,u,_(),v,_(w,x,y,z,A,_(B,C,D,E),F,null,G,z,H,z,I,J,K,null,L,M,N,O,P,Q,R,M),S,_(),T,_(),U,_(V,[_(W,X,Y,Z,ba,bb,q,bc,bd,bc,be,bf,v,_(),S,_(),bg,_(),bh,[_(W,bi,Y,j,ba,bj,q,bk,bd,bk,be,bf,v,_(bl,_(bm,bn,bo,bp),w,bq,br,bs,bt,_(bu,bv,bw,bv)),S,_(),bg,_(),bx,g),_(W,by,Y,j,ba,bb,q,bc,bd,bc,be,bf,v,_(bt,_(bu,bz,bw,bz)),S,_(),bg,_(),bh,[_(W,bA,Y,j,ba,bj,q,bk,bd,bk,be,bf,v,_(bl,_(bm,bB,bo,bC),w,bq,bt,_(bu,bD,bw,bE)),S,_(),bg,_(),bx,g),_(W,bF,Y,j,ba,bG,q,bk,bd,bH,be,bf,v,_(bI,_(B,C,D,bJ,br,bK),bl,_(bm,bK,bo,bL),w,bM,bt,_(bu,bN,bw,bO),bP,_(B,C,D,bJ)),S,_(),bg,_(),bQ,_(bR,bS),bx,g),_(W,bT,Y,j,ba,bG,q,bk,bd,bH,be,bf,v,_(bI,_(B,C,D,bJ,br,bK),bl,_(bm,bK,bo,bL),w,bM,bt,_(bu,bU,bw,bO),bP,_(B,C,D,bJ)),S,_(),bg,_(),bQ,_(bR,bS),bx,g),_(W,bV,Y,j,ba,bG,q,bk,bd,bH,be,bf,v,_(bI,_(B,C,D,bJ,br,bK),bl,_(bm,bK,bo,bL),w,bM,bt,_(bu,bW,bw,bO),bP,_(B,C,D,bJ)),S,_(),bg,_(),bQ,_(bR,bS),bx,g),_(W,bX,Y,j,ba,bY,q,bk,bd,bZ,be,bf,v,_(bI,_(B,C,D,bJ,br,bK),bl,_(bm,ca,bo,bK),w,bM,bt,_(bu,cb,bw,cc),bP,_(B,C,D,bJ)),S,_(),bg,_(),bQ,_(bR,cd),bx,g),_(W,ce,Y,j,ba,bj,q,bk,bd,bk,be,bf,v,_(cf,cg,bl,_(bm,ch,bo,ci),w,cj,bt,_(bu,ck,bw,cl)),S,_(),bg,_(),bx,g),_(W,cm,Y,j,ba,bj,q,bk,bd,bk,be,bf,v,_(cf,cg,bl,_(bm,cn,bo,ci),w,cj,bt,_(bu,co,bw,cl)),S,_(),bg,_(),bx,g),_(W,cp,Y,j,ba,bj,q,bk,bd,bk,be,bf,v,_(cf,cg,bl,_(bm,cn,bo,ci),w,cj,bt,_(bu,cq,bw,cl)),S,_(),bg,_(),bx,g),_(W,cr,Y,j,ba,bj,q,bk,bd,bk,be,bf,v,_(cf,cg,bl,_(bm,cn,bo,ci),w,cj,bt,_(bu,cs,bw,cl)),S,_(),bg,_(),bx,g),_(W,ct,Y,j,ba,bj,q,bk,bd,bk,be,bf,v,_(cf,cg,bl,_(bm,cu,bo,ci),w,cj,bt,_(bu,cv,bw,cw)),S,_(),bg,_(),bx,g),_(W,cx,Y,j,ba,bj,q,bk,bd,bk,be,bf,v,_(bl,_(bm,cy,bo,cz),w,cA,bt,_(bu,cB,bw,cC)),S,_(),bg,_(),bx,g),_(W,cD,Y,j,ba,bG,q,bk,bd,bH,be,bf,v,_(bI,_(B,C,D,bJ,br,bK),bl,_(bm,bK,bo,bL),w,bM,bt,_(bu,cE,bw,bO),bP,_(B,C,D,bJ)),S,_(),bg,_(),bQ,_(bR,bS),bx,g),_(W,cF,Y,j,ba,bj,q,bk,bd,bk,be,bf,v,_(cf,cg,bl,_(bm,cn,bo,ci),w,cj,bt,_(bu,cG,bw,cl)),S,_(),bg,_(),bx,g),_(W,cH,Y,cI,ba,bb,q,bc,bd,bc,be,bf,v,_(),S,_(),bg,_(),bh,[_(W,cJ,Y,cK,ba,bb,q,bc,bd,bc,be,bf,v,_(bt,_(bu,cL,bw,cM)),S,_(),bg,_(),bh,[_(W,cN,Y,j,ba,bj,q,bk,bd,bk,be,bf,v,_(bl,_(bm,cO,bo,cP),w,cQ,bt,_(bu,cR,bw,cS),bP,_(B,C,D,bJ)),S,_(),bg,_(),bx,g),_(W,cT,Y,j,ba,cU,q,cV,bd,cV,be,bf,v,_(bl,_(bm,cW,bo,cX),w,cY,bt,_(bu,cZ,bw,da)),S,_(),bg,_(),bQ,_(bR,db)),_(W,dc,Y,j,ba,bj,q,bk,bd,bk,be,bf,v,_(cf,cg,bl,_(bm,dd,bo,cn),w,de,bt,_(bu,df,bw,dg)),S,_(),bg,_(),bx,g)],dh,g),_(W,di,Y,j,ba,bj,q,bk,bd,bk,be,bf,v,_(bl,_(bm,dj,bo,cz),w,cA,bt,_(bu,co,bw,dk)),S,_(),bg,_(),bx,g),_(W,dl,Y,j,ba,bj,q,bk,bd,bk,be,bf,v,_(bI,_(B,C,D,bJ,br,bK),bl,_(bm,dm,bo,cz),w,cA,bt,_(bu,dn,bw,dk)),S,_(),bg,_(),bx,g),_(W,dp,Y,j,ba,bj,q,bk,bd,bk,be,bf,v,_(bl,_(bm,cy,bo,cz),w,cA,bt,_(bu,dq,bw,dk)),S,_(),bg,_(),bx,g),_(W,dr,Y,j,ba,bj,q,bk,bd,bk,be,bf,v,_(bl,_(bm,dm,bo,cz),w,cA,bt,_(bu,ds,bw,dg)),S,_(),bg,_(),bx,g)],dh,g)],dh,g),_(W,dt,Y,j,ba,bj,q,bk,bd,bk,be,bf,v,_(bl,_(bm,du,bo,dv),w,dw,bt,_(bu,dx,bw,dy)),S,_(),bg,_(),bx,g),_(W,dz,Y,j,ba,bj,q,bk,bd,bk,be,bf,v,_(bl,_(bm,du,bo,dv),w,dw,bt,_(bu,dA,bw,dy)),S,_(),bg,_(),bx,g)],dh,g)])),dB,_(),dC,_(dD,_(dE,dF),dG,_(dE,dH),dI,_(dE,dJ),dK,_(dE,dL),dM,_(dE,dN),dO,_(dE,dP),dQ,_(dE,dR),dS,_(dE,dT),dU,_(dE,dV),dW,_(dE,dX),dY,_(dE,dZ),ea,_(dE,eb),ec,_(dE,ed),ee,_(dE,ef),eg,_(dE,eh),ei,_(dE,ej),ek,_(dE,el),em,_(dE,en),eo,_(dE,ep),eq,_(dE,er),es,_(dE,et),eu,_(dE,ev),ew,_(dE,ex),ey,_(dE,ez),eA,_(dE,eB),eC,_(dE,eD),eE,_(dE,eF)));}; 
var b="url",c="明细.html",d="generationDate",e=new Date(1614681284676.37),f="isCanvasEnabled",g=false,h="isAdaptiveEnabled",i="sketchKeys",j="",k="s0",l="variables",m="OnLoadVariable",n="page",o="packageId",p="8f38d410dfd749f1992fdef1588bccf4",q="type",r="Axure:Page",s="name",t="明细",u="notes",v="style",w="baseStyle",x="627587b6038d43cca051c114ac41ad32",y="pageAlignment",z="near",A="fill",B="fillType",C="solid",D="color",E=0xFFFFFFFF,F="image",G="imageHorizontalAlignment",H="imageVerticalAlignment",I="imageRepeat",J="auto",K="favicon",L="sketchFactor",M="0",N="colorStyle",O="appliedColor",P="fontName",Q="Applied Font",R="borderWidth",S="adaptiveStyles",T="interactionMap",U="diagram",V="objects",W="id",X="be42b0533d2f42bfa91696ab64b3e707",Y="label",Z="消费",ba="friendlyType",bb="组合 ",bc="layer",bd="styleType",be="visible",bf=true,bg="imageOverrides",bh="objs",bi="f071a5c4b8ad4ce1b0e37f56cc759503",bj="矩形",bk="vectorShape",bl="size",bm="width",bn=1213,bo="height",bp=842,bq="47641f9a00ac465095d6b672bbdffef6",br="opacity",bs="0.9",bt="location",bu="x",bv=10,bw="y",bx="generateCompound",by="ca80f589123d4dee87bfb90f3d5d65f2",bz=0,bA="2acc103e33444f9e834bd4ae5c363c53",bB=1178,bC=647,bD=28,bE=35,bF="1f8b9c75ded94b43b4803e4a02a743bd",bG="垂直线",bH="verticalLine",bI="foreGroundFill",bJ=0xFF00CCFF,bK=1,bL=569,bM="619b2148ccc1497285562264d51992f9",bN=739,bO=58,bP="borderFill",bQ="images",bR="normal~",bS="images/明细/u525.png",bT="ffd628e4d5684f32995a6feda3fbbf99",bU=835,bV="1c68811050304e6eaa13c4c34368b1ff",bW=935,bX="4c52ff54b25d410e9f43f319a7aba047",bY="水平线",bZ="horizontalLine",ca=1111,cb=68,cc=78,cd="images/明细/u528.png",ce="b16d40b6a9bc47d591b16c462fb9f5a1",cf="fontWeight",cg="700",ch=73,ci=22,cj="8c7a4c5ad69a4369a5f7788171ac0b32",ck=318,cl=46,cm="5f574bbb9299403f91106b7075b6d775",cn=37,co=764,cp="a2d0f6202b08457094f2da151af7e73f",cq=863,cr="9e1423d5126645d3bee7b41d7f80b4a2",cs=1032,ct="acdda5f149b645e5bc8fdef4ea76c30f",cu=55,cv=991,cw=646,cx="79f2dce01f39432eac6b53d4f723f5ec",cy=51,cz=16,cA="2285372321d148ec80932747449c36c9",cB=1070,cC=649,cD="74fe30f9e8af4c07951e967f4bfc5afb",cE=138,cF="205874dc5e1748908d0b42cb1a52a076",cG=80,cH="69307c5310b548c9a489c47b1ce3afce",cI="销售",cJ="099fe81ea980481e9fb5c14fc5b6f17b",cK="商品图片",cL=31,cM=186,cN="eb4d76f0fe3c4b97a4f1e9b77c6b6f88",cO=572,cP=101,cQ="4b7bfc596114427989e10bb0b557d0ce",cR=149,cS=105,cT="e21ba62f063a403c82646628e3c4a0d1",cU="图片 ",cV="imageBox",cW=160,cX=81,cY="75a91ee5b9d042cfa01b8d565fe289c0",cZ=158,da=117,db="images/商品管理/u196.jpg",dc="c743d1ef5f904d919028f8c3315a9b22",dd=225,de="1111111151944dfba49f67fd55eb1f88",df=365,dg=139,dh="propagate",di="3d2b09baf0f647b290301c65b558b6dd",dj=43,dk=147,dl="474334c575364173a60e08bcad7c9816",dm=9,dn=878,dp="17013dfba32e4bac9daec28f3f623332",dq=1044,dr="9e00176c35ef40c3924463e978d416e9",ds=91,dt="aa3e87b2cfd04e2f9fab6b0bbcc6cc7a",du=140,dv=40,dw="cd64754845384de3872fb4a066432c1f",dx=450,dy=716,dz="fe477d525a394fe0a3a76c1601fc8cfa",dA=696,dB="masters",dC="objectPaths",dD="be42b0533d2f42bfa91696ab64b3e707",dE="scriptId",dF="u521",dG="f071a5c4b8ad4ce1b0e37f56cc759503",dH="u522",dI="ca80f589123d4dee87bfb90f3d5d65f2",dJ="u523",dK="2acc103e33444f9e834bd4ae5c363c53",dL="u524",dM="1f8b9c75ded94b43b4803e4a02a743bd",dN="u525",dO="ffd628e4d5684f32995a6feda3fbbf99",dP="u526",dQ="1c68811050304e6eaa13c4c34368b1ff",dR="u527",dS="4c52ff54b25d410e9f43f319a7aba047",dT="u528",dU="b16d40b6a9bc47d591b16c462fb9f5a1",dV="u529",dW="5f574bbb9299403f91106b7075b6d775",dX="u530",dY="a2d0f6202b08457094f2da151af7e73f",dZ="u531",ea="9e1423d5126645d3bee7b41d7f80b4a2",eb="u532",ec="acdda5f149b645e5bc8fdef4ea76c30f",ed="u533",ee="79f2dce01f39432eac6b53d4f723f5ec",ef="u534",eg="74fe30f9e8af4c07951e967f4bfc5afb",eh="u535",ei="205874dc5e1748908d0b42cb1a52a076",ej="u536",ek="69307c5310b548c9a489c47b1ce3afce",el="u537",em="099fe81ea980481e9fb5c14fc5b6f17b",en="u538",eo="eb4d76f0fe3c4b97a4f1e9b77c6b6f88",ep="u539",eq="e21ba62f063a403c82646628e3c4a0d1",er="u540",es="c743d1ef5f904d919028f8c3315a9b22",et="u541",eu="3d2b09baf0f647b290301c65b558b6dd",ev="u542",ew="474334c575364173a60e08bcad7c9816",ex="u543",ey="17013dfba32e4bac9daec28f3f623332",ez="u544",eA="9e00176c35ef40c3924463e978d416e9",eB="u545",eC="aa3e87b2cfd04e2f9fab6b0bbcc6cc7a",eD="u546",eE="fe477d525a394fe0a3a76c1601fc8cfa",eF="u547";
return _creator();
})());

$(function(){
  var code = window.location.search.substring(1,window.location.search.length);
  find(code);

})
function find(code){
    db = openDatabase('mydb', '1.0', 'Test DB', 20 * 1024 * 1024);
    db.transaction(function (tx) {
    tx.executeSql("select GOODS.name,sum(DETAIL.num) num,DETAIL.price,GOODS.img from DETAIL LEFT JOIN  GOODS  ON DETAIL.goodscode=GOODS.CODE WHERE DETAIL.cardcode=?  group by DETAIL.goodscode", [code.toString()], function (tx, result) {
        var msg = '';
        var sum = 0;
        for (var i = 0; i < result.rows.length; i++) {
            //图片为空设置默认图片
            var imgs = result.rows[i].img!=null&&result.rows[i].img!=''?result.rows[i].img:'images/商品管理/u196.jpg';
            var name = result.rows[i].name != null && result.rows[i].name != '' ? result.rows[i].name : '';
            sum = sum + parseFloat(result.rows[i].price * result.rows[i].num);
            msg += '<div  class="ax_default u537" data-label="销售" data-left="91" data-top="105" data-width="1004" data-height="101">'
            msg += '<tr><td><div  class="ax_default u538" data-label="商品图片" data-left="149" data-top="105" data-width="572" data-height="101">'
            msg += '<div  class="ax_default box_1 u539">'
            msg += '<div  class="u539_div"></div></div>'
            msg += '<div  class="ax_default image u540">'
            msg += '<img  class="img u540_img" src="'+imgs+'"/> </div></td>'
            msg += '<td><div  class="ax_default _一级标题 u541">'
            msg += '<div  class="u541_div"></div>'
            msg += '<div  class="text u541_text">'
            msg += '<p><span>' + name + '</span></p> </div></div></div></td>'
            msg +='<td><div  class="ax_default label u542">'
            msg +='<div  class="u542_div"></div>'
            msg +='<div  class="text u542_text">'
            msg +='<p><span style="color:#00B2DF;">'+toDecimal(result.rows[i].price)+'</span><span>￥</span></p> </div></div></td>'
            msg +='<td><div  class="ax_default label u543">'
            msg +='<div  class="u543_div"></div>'
            msg +='<div  class="text u543_text">'
            msg +='<p><span>'+result.rows[i].num+'</span></p></div></div></td>'
            msg +='<td><div  class="ax_default label u544">'
            msg +='<div class="u544_div"></div>'
            msg +='<div  class="text u544_text">'
            msg +='<p><span style="color:#00B2DF;">'+toDecimal(result.rows[i].price * result.rows[i].num)+'</span><span>￥</span></p></div></div></td>'
            msg +='<td><div  class="ax_default label u545">'
            msg +='<div  class="u545_div"></div>'
            msg +='<div id="u545_text" class="text u545_text">'
            msg +='<p><span>'+(i+1)+'</span></p></div></div> </div></td></tr>'
        }
        $('#sum').html(toDecimal(sum));
        $('#mainbody').html(msg);
        window.print();
        setTimeout("window.close();", 0);
    }, function () {
        console.info("查询数据失败！")
    })
})}

/**
 * 强制保留两位小数
 *@param x 传入数值
 */
function toDecimal(x) {
    var f = parseFloat(x);
    if (isNaN(f)) {
        return false;
    }
    var f = Math.round(x * 100) / 100;
    var s = f.toString();
    var rs = s.indexOf('.');
    if (rs < 0) {
        rs = s.length;
        s += '.';
    }
    while (s.length <= rs + 2) {
        s += '0';
    }
    return s;
}
